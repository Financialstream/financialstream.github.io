(() => {
  const i18n = {
    en: {
      nav: {
        services: 'Services',
        process: 'Process',
        faq: 'FAQ',
        contact: 'Contact',
      },
      cta: {
        bookTop: 'Book a Free Consultation',
        seeServices: 'See services',
        ctaTitle: 'Ready to get started?',
        ctaText: 'Book a free consultation or send a request — we’ll reply shortly.',
        ctaButton: 'Request a Free Consultation',
      },
      hero: {
        title1: 'Accounting & Bookkeeping',
        title2: 'for Small Businesses & Individuals',
        subtitle: 'Monthly bookkeeping, tax preparation, and clean reporting — built for clarity, not chaos.',
        body: 'We provide reliable bookkeeping, tax preparation, and financial support for small businesses and individuals across the United States. Our goal is to keep your finances accurate, organized, and compliant — without stress or confusion. Whether you are running a business, working as a freelancer, or managing personal taxes, we help you stay in control and avoid costly mistakes. You get clear reports, timely filings, and responsive support, so you can focus on your work while we handle the numbers. Start with a free consultation to understand your situation and the best next steps.',
      },
      pill: {
        lang: 'Bilingual: English / Russian',
      },
      badges: {
        response: 'Fast response',
        reports: 'Clean monthly reports',
        us: 'US small-business focused',
      },
      services: {
        title: 'Our Services',
        subtitle: 'Clear scope, predictable workflow, and clean outputs you can rely on.',
        card1: {
          title: 'Bookkeeping',
          desc: 'Monthly bookkeeping, reconciliations, and reports to keep your numbers accurate.',
        },
        card2: {
          title: 'Tax Preparation',
          desc: 'Tax filing for individuals and businesses, with a focus on maximizing deductions.',
        },
        card3: {
          title: 'Payroll',
          desc: 'Payroll processing and filings (W-2 / 1099) — accurate and on time.',
        },
        card4: {
          title: 'Cleanup & Catch‑Up',
          desc: 'Fix past months, organize records, and get back to a clean baseline.',
        },
        card5: {
          title: 'New Business Setup',
          desc: 'Accounting system setup, chart of accounts, and basic process guidance.',
        },
        card6: {
          title: 'Support & Advisory',
          desc: 'Clear answers, monthly check‑ins, and practical guidance when you need it.',
        },
      },
      process: {
        title: 'How it works',
        subtitle: 'A simple flow that keeps finances under control.',
        p1: {
          title: 'Free consultation',
          desc: 'We understand your situation and confirm scope.',
        },
        p2: {
          title: 'Secure onboarding',
          desc: 'We collect access and documents with clear instructions.',
        },
        p3: {
          title: 'Monthly close',
          desc: 'Reconciliations and cleanup — consistent and on time.',
        },
      },
      reviews: {
        title: 'Client reviews',
        subtitle: 'Hundreds of clients trust us — here are a few notes.',
        r1: { text: '“Clear, fast, and accurate. We finally have clean monthly reports.”', name: 'Alex' },
        r2: { text: '“Great communication and everything is organized. Highly recommend.”', name: 'Olga' },
        r3: { text: '“They helped me fix issues from the previous bookkeeper and set everything up correctly.”', name: 'Svetlana' },
        r4: { text: '“Professional service and quick answers — exactly what a small business needs.”', name: 'Viktor' },
        r5: { text: '“Very attentive approach. Everything is on time and stress‑free.”', name: 'Tetiana' },
      },
      faq: {
        title: 'FAQ',
        subtitle: 'Answers to common questions.',
        q1: { q: 'Do you work with both individuals and businesses?', a: 'Yes. We support individuals, freelancers, and small businesses across the US.' },
        q2: { q: 'Which software do you use?', a: 'We work with QuickBooks and Xero, depending on your needs and current setup.' },
        q3: { q: 'How fast can we start?', a: 'Often within a few days after the initial call and access collection.' },
        q4: { q: 'Can you help with past‑due bookkeeping?', a: 'Yes. We can clean up and catch up past periods, then move to monthly support.' },
      },
      contact: {
        title: 'Contact',
        subtitle: 'Tell us what you need — we’ll reply shortly.',
        phoneLabel: 'Phone',
        emailLabel: 'Email',
        websiteLabel: 'Website',
      },
      form: {
        title: 'Request a free consultation',
        subtitle: 'Or ask a question.',
        name: 'Your Name',
        phone: 'Phone Number',
        email: 'Email',
        message: 'Message',
        submit: 'Send Request',
        thankYouTitle: 'Thank you!',
        thankYouText: 'Your request has been sent. We will contact you shortly.',
      },
      footer: {
        rights: '© 2026 Financial Stream LLC',
      },
    },

    ru: {
      nav: {
        services: 'Услуги',
        process: 'Процесс',
        faq: 'Вопросы',
        contact: 'Контакты',
      },
      cta: {
        bookTop: 'Бесплатная консультация',
        seeServices: 'Смотреть услуги',
        ctaTitle: 'Готовы начать?',
        ctaText: 'Запишитесь на бесплатную консультацию или отправьте запрос — мы ответим в ближайшее время.',
        ctaButton: 'Записаться на бесплатную консультацию',
      },
      hero: {
        title1: 'Бухгалтерия и учет',
        title2: 'для малого бизнеса и частных лиц',
        subtitle: 'Ежемесячный учет, налоги и понятные отчеты — для ясности, а не хаоса.',
        body: 'Мы предоставляем надежное бухгалтерское сопровождение, подготовку налогов и финансовую поддержку для малого бизнеса и частных лиц по всей территории США. Наша цель — чтобы ваши финансы были точными, организованными и соответствовали требованиям — без стресса и путаницы. Независимо от того, ведете ли вы бизнес, работаете как фрилансер или занимаетесь личными налогами, мы помогаем держать все под контролем и избегать дорогих ошибок. Вы получаете понятные отчеты, своевременные подачи и быстрые ответы, чтобы вы могли заниматься своим делом, а цифры мы возьмем на себя. Начните с бесплатной консультации — разберемся в ситуации и предложим лучшие следующие шаги.',
      },
      pill: {
        lang: 'Два языка: Английский / Русский',
      },
      badges: {
        response: 'Быстрый ответ',
        reports: 'Понятные ежемесячные отчеты',
        us: 'Фокус на малом бизнесе США',
      },
      services: {
        title: 'Наши услуги',
        subtitle: 'Понятный объем работ, предсказуемый процесс и чистый результат.',
        card1: {
          title: 'Бухгалтерия (Bookkeeping)',
          desc: 'Ежемесячный учет, сверки и отчеты — чтобы цифры были точными.',
        },
        card2: {
          title: 'Налоги (Tax Preparation)',
          desc: 'Подготовка и подача налогов для физлиц и бизнеса с учетом вычетов.',
        },
        card3: {
          title: 'Зарплата (Payroll)',
          desc: 'Начисление зарплаты и формы (W‑2 / 1099) — точно и вовремя.',
        },
        card4: {
          title: 'Наведение порядка (Cleanup)',
          desc: 'Исправим прошлые месяцы,整理记录 и вернем учет в норму.',
        },
        card5: {
          title: 'Настройка для нового бизнеса',
          desc: 'Настроим учетную систему, план счетов и базовые процессы.',
        },
        card6: {
          title: 'Поддержка и консультации',
          desc: 'Понятные ответы, регулярные проверки и практические рекомендации.',
        },
      },
      process: {
        title: 'Как мы работаем',
        subtitle: 'Простой процесс, который держит финансы под контролем.',
        p1: {
          title: 'Бесплатная консультация',
          desc: 'Разбираем вашу ситуацию и согласуем объем работ.',
        },
        p2: {
          title: 'Безопасный старт',
          desc: 'Собираем доступы и документы по понятным инструкциям.',
        },
        p3: {
          title: 'Ежемесячное закрытие',
          desc: 'Сверки и порядок — стабильно и в срок.',
        },
      },
      reviews: {
        title: 'Отзывы клиентов',
        subtitle: 'Нам доверяют сотни клиентов — вот несколько коротких отзывов.',
        r1: { text: '“Четко, быстро и аккуратно. Наконец-то есть нормальные ежемесячные отчеты.”', name: 'Алексей' },
        r2: { text: '“Отличная коммуникация, все разложили по полочкам. Рекомендую.”', name: 'Ольга' },
        r3: { text: '“Помогли исправить ошибки прошлого бухгалтера и настроили учет правильно.”', name: 'Светлана' },
        r4: { text: '“Профессионально и быстро отвечают — именно то, что нужно малому бизнесу.”', name: 'Виктор' },
        r5: { text: '“Очень внимательный подход. Все вовремя и без стресса.”', name: 'Татьяна' },
      },
      faq: {
        title: 'Частые вопросы',
        subtitle: 'Короткие ответы на популярные вопросы.',
        q1: { q: 'Вы работаете и с частными лицами, и с бизнесом?', a: 'Да. Мы работаем с физлицами, фрилансерами и малым бизнесом по США.' },
        q2: { q: 'С какими программами вы работаете?', a: 'Чаще всего QuickBooks и Xero — в зависимости от вашей ситуации.' },
        q3: { q: 'Как быстро можно начать?', a: 'Обычно — в течение нескольких дней после созвона и получения доступов.' },
        q4: { q: 'Можете ли вы “догнать” прошлые месяцы?', a: 'Да. Мы делаем cleanup/catch‑up и затем переходим на ежемесячное сопровождение.' },
      },
      contact: {
        title: 'Контакты',
        subtitle: 'Опишите задачу — мы ответим в ближайшее время.',
        phoneLabel: 'Телефон',
        emailLabel: 'Email',
        websiteLabel: 'Сайт',
      },
      form: {
        title: 'Записаться на бесплатную консультацию',
        subtitle: 'Или задайте вопрос.',
        name: 'Ваше имя',
        phone: 'Телефон',
        email: 'Email',
        message: 'Сообщение',
        submit: 'Отправить запрос',
        thankYouTitle: 'Спасибо!',
        thankYouText: 'Ваш запрос отправлен. Мы свяжемся с вами в ближайшее время.',
      },
      footer: {
        rights: '© 2026 Financial Stream LLC',
      },
    },
  };

  const getNested = (obj, path) => path.split('.').reduce((o, k) => (o && k in o ? o[k] : undefined), obj);

  function setLanguage(lang) {
    if (!i18n[lang]) return;

    // Text content
    document.querySelectorAll('[data-i18n]').forEach((el) => {
      const key = el.getAttribute('data-i18n');
      const value = getNested(i18n[lang], key);
      if (typeof value === 'string') {
        el.textContent = value;
      }
    });

    // Placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach((el) => {
      const key = el.getAttribute('data-i18n-placeholder');
      const value = getNested(i18n[lang], key);
      if (typeof value === 'string') {
        el.setAttribute('placeholder', value);
      }
    });

    // Reviews cards
    for (let i = 1; i <= 5; i++) {
      const t = getNested(i18n[lang], `reviews.r${i}.text`);
      const n = getNested(i18n[lang], `reviews.r${i}.name`);
      const tEl = document.querySelector(`[data-i18n="reviews.r${i}.text"]`);
      const nEl = document.querySelector(`[data-i18n="reviews.r${i}.name"]`);
      if (tEl && typeof t === 'string') tEl.textContent = t;
      if (nEl && typeof n === 'string') nEl.textContent = n;
    }

    // Active state
    document.querySelectorAll('.lang__btn').forEach((btn) => {
      const isActive = btn.getAttribute('data-lang') === lang;
      btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
    });

    // Store
    localStorage.setItem('fs_lang', lang);
    document.documentElement.setAttribute('lang', lang);

    // Hidden language field for Formspree (optional)
    const formLang = document.getElementById('formLang');
    if (formLang) formLang.value = lang;
  }

  // Hook language buttons
  document.querySelectorAll('.lang__btn').forEach((btn) => {
    btn.addEventListener('click', () => setLanguage(btn.getAttribute('data-lang')));
  });

  // Init language
  const saved = localStorage.getItem('fs_lang');
  const initial = saved ? saved : (((navigator.language || '').toLowerCase().startsWith('ru')) ? 'ru' : 'en');
  setLanguage(initial);

  // Simple success message based on URL param (?sent=1)
  try {
    const params = new URLSearchParams(window.location.search);
    if (params.get('sent') === '1') {
      const t = document.getElementById('thankyou');
      if (t) t.style.display = 'block';
      // Remove the param from URL (optional, no reload)
      params.delete('sent');
      const clean = `${window.location.pathname}${params.toString() ? '?' + params.toString() : ''}${window.location.hash || ''}`;
      window.history.replaceState({}, '', clean);
    }
  } catch (_) {
    // no-op
  }
})();
